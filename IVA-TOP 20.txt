SELECT TOP 20 * FROM
(SELECT A.MERCHANT_ID, A.MERCHANT_NAME, B.TAX_PAYER_ID, MES,
 A.TOTTRANS, A.TOTCOMS_PC FROM
  (SELECT MERCHANT_ID, MERCHANT_NAME, ROUND(AVG(MONTH(REPORT_DATE_LOCAL)),0) MES,
   SUM(TOTAL_TRANSACTIONS) TOTTRANS, SUM(TOTAL_FEES_CHARGED) TOTCOMS_PC 
  FROM "PRD_CLIP_ANALYTICS"."CLIPDW_SETTLEMENT"."REPORTS"
  WHERE TOTAL_TRANSACTIONS>0 AND YEAR(REPORT_DATE_LOCAL)=2020 
   AND MONTH(REPORT_DATE_LOCAL)=12
  GROUP BY MERCHANT_ID, MERCHANT_NAME
  ORDER BY TOTCOMS_PC DESC) A
LEFT JOIN "PRD_CLIP_ANALYTICS"."CLIPDW_PROVISIONING"."MERCHANT_TAXPAYER_INFO" B
ON A.MERCHANT_ID=B.MERCHANT_ID
WHERE B.TAX_PAYER_ID IS NOT NULL)
ORDER BY TOTCOMS_PC DESC;